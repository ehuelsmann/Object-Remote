#!/usr/bin/env perl

use strictures 1;
use Object::Remote::Connector::STDIO;
use Object::Remote;
use CPS::Future;

#$Object::Remote::Connection::DEBUG = 1;

my $c = Object::Remote::Connector::STDIO->new->connect;

my $loop = Object::Remote->current_loop;

my $f = CPS::Future->new;

$f->on_ready(sub { $loop->stop });

$c->on_close($f);

print { $c->send_to_fh } "Shere\n";

$loop->run;
